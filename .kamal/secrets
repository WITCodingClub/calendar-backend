# Secrets defined here are available for reference under registry/password, env/secret, builder/secrets,
# and accessories/*/env/secret in config/deploy.yml. All secrets should be pulled from either
# password manager, ENV, or a file. DO NOT ENTER RAW CREDENTIALS HERE! This file needs to be safe for git.

# Example of extracting secrets from 1password (or another compatible pw manager)
# SECRETS=$(kamal secrets fetch --adapter 1password --account your-account --from Vault/Item KAMAL_REGISTRY_PASSWORD RAILS_MASTER_KEY)
# KAMAL_REGISTRY_PASSWORD=$(kamal secrets extract KAMAL_REGISTRY_PASSWORD ${SECRETS})
# RAILS_MASTER_KEY=$(kamal secrets extract RAILS_MASTER_KEY ${SECRETS})

# Use GitHub token for GHCR authentication
# Option 1: Use gh CLI token (must have write:packages scope)
KAMAL_REGISTRY_PASSWORD=$(gh auth token)
# Option 2: Use explicit PAT from environment (uncomment and set GITHUB_PAT_PACKAGES env var)
# KAMAL_REGISTRY_PASSWORD=$GITHUB_PAT_PACKAGES

# Use production credentials key (Rails 8 uses encrypted credentials, not master.key)
RAILS_MASTER_KEY=$(cat config/credentials/production.key)

# PostgreSQL password for production database
# Generate a secure password: openssl rand -base64 32
# Store it in config/credentials/postgres_password (gitignored)
POSTGRES_PASSWORD=$(cat config/credentials/postgres_password 2>/dev/null || echo "CHANGE_ME_$(openssl rand -base64 16)")

# Use same password for both Kamal accessory and Rails app
DB_PASSWORD=$POSTGRES_PASSWORD
